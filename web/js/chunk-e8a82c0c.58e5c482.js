(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e8a82c0c"],{"05ce":function(t,e,a){var n=a("6809").PROPER,o=a("2c48"),i=a("cb1f"),s="​᠎";t.exports=function(t){return o((function(){return!!i[t]()||s[t]()!==s||n&&i[t].name!==t}))}},"0e7d":function(t,e,a){"use strict";a("5aae");e["a"]={data:function(){return{export:"",order:null,sort:null,minDate:Math.ceil((new Date-new Date("2018-1-1"))/864e5),shortcutsSetting:["yesterday","lastSeven","lastThirty","lastWeek","lastMonth"]}},mounted:function(){},methods:{sortChangeHandle:function(t){t.order?(this.order=t.prop,this.sort="descending"===t.order?"desc":"asc"):(this.order=null,this.sort=null),this.tableLoad()},downloadReport:function(t){var e=this;this["export"]=t,0===this.tableData.length?this.$message.warning("没有数据可以下载"):this.requestTable().then((function(t){if(200===t.data.code){var a=e.$router.resolve({name:"downloadCenter"}).href;e.$message.success({dangerouslyUseHTMLString:!0,message:'已添加到下载中心，请到<a class="redirect-download" href='.concat(a,">下载中心</a>查看")})}})),this["export"]=""},search:function(){this.tableLoad()}}}},"336e":function(t,e,a){"use strict";a("9335")},4633:function(t,e,a){},"47e8":function(t,e,a){"use strict";var n=a("9c15"),o=a("b5db").trim,i=a("05ce");n({target:"String",proto:!0,forced:i("trim")},{trim:function(){return o(this)}})},"4bbd":function(t,e,a){"use strict";e["a"]={data:function(){return{pageSize:10,total:0,currentPage:1,header:null,tableData:[],loading:!1}},mounted:function(){},methods:{pageChange:function(t,e,a){this.currentPage=a,t.call(e,a)},pageSizeChange:function(t,e,a){this.pageSize=a,this.pageChange(t,e,1)}}}},"5aae":function(t,e,a){"use strict";var n=a("9c15"),o=a("5008"),i=a("1c72"),s=a("059d"),r=a("d7ab"),l=a("ffb3"),c=a("2c48"),u=a("430c"),d=a("130a"),m=a("c91b"),p=a("e9db"),h=a("d006"),f=a("8289"),g=[],b=o(g.sort),v=o(g.push),_=c((function(){g.sort(void 0)})),C=c((function(){g.sort(null)})),y=d("sort"),D=!c((function(){if(h)return h<70;if(!(m&&m>3)){if(p)return!0;if(f)return f<603;var t,e,a,n,o="";for(t=65;t<76;t++){switch(e=String.fromCharCode(t),t){case 66:case 69:case 70:case 72:a=3;break;case 68:case 71:a=4;break;default:a=2}for(n=0;n<47;n++)g.push({k:e+n,v:a})}for(g.sort((function(t,e){return e.v-t.v})),n=0;n<g.length;n++)e=g[n].k.charAt(0),o.charAt(o.length-1)!==e&&(o+=e);return"DGBEFHACIJK"!==o}})),S=_||!C||!y||!D,w=function(t){return function(e,a){return void 0===a?-1:void 0===e?1:void 0!==t?+t(e,a)||0:l(e)>l(a)?1:-1}};n({target:"Array",proto:!0,forced:S},{sort:function(t){void 0!==t&&i(t);var e=s(this);if(D)return void 0===t?b(e):b(e,t);var a,n,o=[],l=r(e);for(n=0;n<l;n++)n in e&&v(o,e[n]);u(o,w(t)),a=o.length,n=0;while(n<a)e[n]=o[n++];while(n<l)delete e[n++];return e}})},6860:function(t,e,a){"use strict";a.d(e,"a",(function(){return o}));a("c510"),a("f8c2"),a("6010"),a("e15d"),a("e4de"),a("d64c"),a("98ff");var n=a("a01c");function o(t,e){if(t){if("string"===typeof t)return Object(n["a"])(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?Object(n["a"])(t,e):void 0}}},7980:function(t,e,a){"use strict";a.d(e,"a",(function(){return l}));a("828e");var n=a("a01c");function o(t){if(Array.isArray(t))return Object(n["a"])(t)}a("74c4"),a("1f83"),a("f8c2"),a("2da9"),a("e4de"),a("b00a"),a("e15d");function i(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}var s=a("6860");function r(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function l(t){return o(t)||i(t)||Object(s["a"])(t)||r()}},"79b9":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"flex-vertical flex-1"},[a("el-form",{ref:"addOptions",staticClass:"customized-form padding-top background-white p-l-r-24 m-l-r-16",attrs:{inline:!0,model:t.optionsForm,rules:t.addOptionsRule}},[a("div",{staticClass:"flex"},[a("span",{staticClass:"inline-block form-item-title"},[t._v("基础筛选")]),a("div",{staticClass:"flex-1"},[a("el-form-item",{attrs:{prop:"dateValue"}},[a("customized-time-picker",{staticClass:"time-picker long-item",attrs:{date:t.optionsForm.dateValue,shortcutsSetting:t.shortcutsSetting,"max-date":1,"min-date":t.minDate},on:{"update:date":function(e){return t.$set(t.optionsForm,"dateValue",e)}}})],1),a("el-form-item",{staticClass:"search-content",attrs:{prop:"selectValue",required:!1}},[a("el-input",{staticClass:"long-item input-with-select",attrs:{placeholder:"请输入所要查询的内容"},model:{value:t.optionsForm.inputValue,callback:function(e){t.$set(t.optionsForm,"inputValue",e)},expression:"optionsForm.inputValue"}},[a("el-select",{attrs:{slot:"prepend",placeholder:"选择类型",clearable:""},slot:"prepend",model:{value:t.optionsForm.selectValue,callback:function(e){t.$set(t.optionsForm,"selectValue",e)},expression:"optionsForm.selectValue"}},t._l(t.selectType,(function(t){return a("el-option",{key:t.id,attrs:{label:t.value,value:t.id}})})),1)],1)],1),a("el-form-item",{staticClass:"long-item",attrs:{prop:"agentCustomer"}},[a("el-select",{attrs:{placeholder:"全部代理商客户",clearable:""},on:{change:t.getAgentCustomer},model:{value:t.optionsForm.agentCustomer,callback:function(e){t.$set(t.optionsForm,"agentCustomer",e)},expression:"optionsForm.agentCustomer"}},t._l(t.optionsForm.agentCustomerList,(function(t){return a("el-option",{key:t.company_id,attrs:{label:t.company_name,value:t.company_id}})})),1)],1),a("el-form-item",{staticClass:"agent-account-item",attrs:{prop:"agentAccount"}},[a("el-select",{attrs:{placeholder:"全部代理商账户",clearable:""},on:{change:t.getAgentAccount},model:{value:t.optionsForm.agentAccount,callback:function(e){t.$set(t.optionsForm,"agentAccount",e)},expression:"optionsForm.agentAccount"}},t._l(t.optionsForm.agentAccountList,(function(t){return a("el-option",{key:t.agent_id,attrs:{label:t.agent_name,value:t.agent_id}})})),1)],1),a("el-form-item",{staticClass:"long-item",attrs:{prop:"platform"}},[a("el-select",{attrs:{placeholder:"投放平台",clearable:""},model:{value:t.optionsForm.platform,callback:function(e){t.$set(t.optionsForm,"platform",e)},expression:"optionsForm.platform"}},t._l(t.optionsForm.platFormList,(function(t){return a("el-option",{key:t.key,attrs:{label:t.value,value:t.key}})})),1)],1),a("el-form-item",{staticClass:"search-btn"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.search("addOptions")}}},[t._v("查询")]),a("el-button",{staticClass:"reset",on:{click:t.reset}},[t._v("重置")])],1)],1)])]),a("basic-report",{ref:"basicReport",attrs:{tableHeader:t.header,showCost:"plan",storageName:"financeCenterPlanReport",sumUrl:"/report/finance/schedule-by-inventory-sum",tableDataUrl:"/report/finance/schedule-by-inventory",formData:t.optionsForm}})],1)},o=[],i=a("7eeb"),s=a("0e7d"),r=a("973c"),l=[{value:"计划ID",id:"ad_id"},{value:"广告主账户或ID",id:"advertiser_id"}],c=[{prop:"stat_datetime",label:"统计时间",sortable:"descending",fixed:!0,minWidth:"100",checkBoxDisabled:!0},{prop:"ad_id",label:"计划ID",minWidth:"160",fixed:!0,checkBoxDisabled:!0},{prop:"ad_name",label:"计划名称",minWidth:"160",fixed:!0,checkBoxDisabled:!0},{prop:"ad_start_time",label:"起始时间",minWidth:"200"},{prop:"ad_end_time",label:"截止时间",minWidth:"200"},{prop:"advertiser_id",label:"广告主账户ID",minWidth:"200"},{prop:"advertiser_name",label:"广告主账户",minWidth:"200"},{prop:"advertiser_industry",label:"广告主行业",minWidth:"180"},{prop:"agent_name",label:"代理商账户",minWidth:"150"},{prop:"agent_customer_name",label:"代理商客户",minWidth:"150"},{prop:"cost",label:"总消耗",minWidth:"120",sortable:"descending"},{prop:"show",label:"展示数",minWidth:"80"},{prop:"avg_show_cost",label:"平均千次展现成本(元)",minWidth:"180"},{prop:"click",label:"点击量",minWidth:"80"},{prop:"avg_click_cost",label:"平均点击单价(元)",minWidth:"180"},{prop:"ctr",label:"点击率",minWidth:"120",sortable:"descending"},{prop:"convert",label:"转化数",minWidth:"120",sortable:"descending"},{prop:"convert_cost",label:"转化成本",minWidth:"100",sortable:"descending"},{prop:"convert_rate",label:"转化率",minWidth:"120",sortable:"descending"},{prop:"total_play",label:"播放数",minWidth:"120",sortable:"descending"},{prop:"valid_play",label:"有效播放数",minWidth:"100"},{prop:"valid_play_rate",label:"有效播放率",minWidth:"100"},{prop:"valid_play_cost",label:"有效播放成本",minWidth:"120"},{prop:"message_action",label:"私信数",minWidth:"80"},{prop:"like",label:"点赞数",minWidth:"80"},{prop:"comment",label:"评论数",minWidth:"80"},{prop:"follow",label:"新增关注数",minWidth:"120"},{prop:"share",label:"分享数",minWidth:"80"},{prop:"inventory",label:"投放平台",minWidth:"80"}],u={name:"PlanReport",components:{BasicReport:r["a"]},mixins:[s["a"]],activated:function(){this.planReportPlatform(),this.handleAgent()},deactivated:function(){this.reset()},data:function(){return{selectType:l,header:c,shortcutsSetting:["yesterday","lastSeven","lastThirty","lastWeek","lastMonth"],optionsForm:{selectValue:"ad_id",inputValue:"",dateValue:Object(i["f"])(1,1),agentCustomer:"",agentCustomerList:[],agentAccount:"",agentAccountList:[],platform:"",platFormList:[]},addOptionsRule:{dateValue:[{validator:this.dateValueValidate,message:"单次查询时间跨度不能超过30天！"}]}}},methods:{getAgentCustomer:function(t){this.handleAgent({company_id:t,agent_id:this.optionsForm.agentAccount})},getAgentAccount:function(t){this.handleAgent({agent_id:t,company_id:this.optionsForm.agentCustomer})},search:function(){this.$refs.basicReport.tableLoad()},handleAgent:function(t){var e=this;this.$http.get("/report/finance/get-labels",{params:t}).then((function(t){200===t.data.code&&(e.optionsForm.agentCustomerList=t.data.data.company,e.optionsForm.agentAccountList=t.data.data.agent)}))},planReportPlatform:function(){var t=this;this.$http.get("/report/finance/get-schedule-inventory").then((function(e){200===e.data.code&&(t.optionsForm.platFormList=e.data.data.list)}))},reset:function(){this.optionsForm.inputValue="",this.$refs.addOptions.resetFields(),this.handleAgent()},dateValueValidate:function(t,e,a){2!==e.length&&a(new Error);var n=Math.ceil((e[1]-e[0])/864e5)<=30;n?a():a(new Error)}}},d=u,m=(a("336e"),a("cba8")),p=Object(m["a"])(d,n,o,!1,null,"2fec7e18",null);e["default"]=p.exports},"7eeb":function(t,e,a){"use strict";a.d(e,"f",(function(){return i})),a.d(e,"c",(function(){return s})),a.d(e,"g",(function(){return r})),a.d(e,"b",(function(){return l})),a.d(e,"e",(function(){return c})),a.d(e,"a",(function(){return u})),a.d(e,"d",(function(){return d}));var n=a("7980"),o=(a("1ae6"),a("f904")),i=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=new Date,n=new Date,o=e+t-1;return a.setTime(a.getTime()-864e5*o),n.setTime(n.getTime()-864e5*e),[a,n]},s=function(){var t=new Date,e=new Date,a=t.getDay()>0?t.getDay()-1:6;return e.setTime(e.getTime()-864e5*a),[e,t]},r=function(){var t=new Date,e=new Date,a=t.getDay();return e.setTime(e.getTime()-864e5*(a+6)),t.setTime(t.getTime()-864e5*a),[e,t]},l=function(){var t=new Date,e=new Date,a=t.getDate()-1;return e.setTime(e.getTime()-864e5*a),[e,t]},c=function(){var t=new Date,e=t.getDate(),a=t.getFullYear()-(t.getMonth()>0?0:1),n=(t.getMonth()+11)%12,o=new Date(a,n,1);return t.setTime(t.getTime()-864e5*e),[o,t]},u={yesterday:{label:"昨日消耗",legend:"前日环比",handler:i,params:[1,1]},lastSeven:{label:"近七日消耗",legend:"上一周期环比",handler:i,params:[7,1]},thisWeek:{label:"本周消耗",legend:"上一周环比",handler:s},thisMonth:{label:"本月消耗",legend:"上月环比",handler:l}},d=function(t){var e=u[t],a=e.params?e.params:[],i=e.handler.apply(e,Object(n["a"])(a));return i=i.map((function(t){return o["a"].getNewDay(t)})),i}},8289:function(t,e,a){var n=a("6532"),o=n.match(/AppleWebKit\/(\d+)\./);t.exports=!!o&&+o[1]},"828e":function(t,e,a){var n=a("9c15"),o=a("81c6");n({target:"Array",stat:!0},{isArray:o})},9335:function(t,e,a){},"973c":function(t,e,a){"use strict";var n=function(){var t=this,e=this,a=e.$createElement,n=e._self._c||a;return n("div",{staticClass:"m-l-r-16 flex-1 flex-vertical"},[n("div",{staticClass:"background-white m-t-b-20 table-box flex-vertical flex-1"},[n("div",{staticClass:"report-title m-t-b-16 p-l-r-24 clear-float"},[n("div",{staticClass:"inline-block"},["summary"===e.showCost?n("span",[n("span",{staticClass:"inline-block iconfont icon-prompt m-r-10",attrs:{title:"数值汇总与数值筛选不联动"}}),n("span",{staticClass:"inline-block m-r-25"},[e._v("总消耗(计划)："+e._s(e.summaryCostSum.ad_cost_sum)+" 元")]),n("span",{staticClass:"inline-block m-r-25"},[e._v("总消耗(广告主)："+e._s(e.summaryCostSum.adv_cost_sum)+" 元")])]):e._e(),"summary"!==e.showCost?n("span",{staticClass:"inline-block m-r-25"},[e._v("总消耗："+e._s("plan"===e.showCost?e.planCostSum:e.consumeCostSum.cost)+" 元")]):e._e(),"plan"!==e.showCost?n("span",[n("span",{staticClass:"inline-block m-r-25"},[e._v("非赠款消耗："+e._s("summary"===e.showCost?e.summaryCostSum.un_grants_cost_sum:e.consumeCostSum.un_grants_cost)+" 元")]),n("span",{staticClass:"inline-block m-r-25"},[e._v("赠款消耗："+e._s("summary"===e.showCost?e.summaryCostSum.grants_cost_sum:e.consumeCostSum.grants_cost)+" 元")]),n("span",{staticClass:"inline-block"},[e._v("代理商业绩消耗："+e._s("summary"===e.showCost?e.summaryCostSum.agent_cost_sum:e.consumeCostSum.agent_cost)+" 元")])]):e._e()]),n("div",{staticClass:"inline-block f-r"},[n("el-button",{staticClass:"customized-button iconfont icon-select",on:{click:e.select}},[e._v("选择指标")]),n("el-button",{staticClass:"customized-button iconfont icon-download",on:{click:function(t){return e.downloadReport(1)}}},[e._v("下载报表 ")])],1)]),n("customized-table",{ref:"customizedTable",staticClass:"customized-table mini-table has-border flex-1 p-l-r-24",attrs:{"scroll-in-table":!1,loading:e.loading,Header:e.header,Data:e.tableData,total:e.total,"page-size":e.pageSize,"current-page":e.currentPage},on:{"size-change":function(a){e.pageSizeChange(e.tableLoad,t,a)},"current-change":function(a){e.pageChange(e.tableLoad,t,a)},"sort-change":e.sortChangeHandle}})],1),n("customized-dialog",{attrs:{title:"选择指标",width:630,visible:e.visibleDialog,showFooter:!0},on:{close:e.closeDialog,submit:e.submitData,cancel:e.closeDialog}},[n("el-row",e._l(e.tableHeader,(function(t,a){return n("el-col",{key:a,attrs:{span:6}},[n("el-checkbox-group",{model:{value:e.fixedHeaderProp,callback:function(t){e.fixedHeaderProp=t},expression:"fixedHeaderProp"}},[n("el-checkbox",{attrs:{disabled:t.checkBoxDisabled,label:t.prop,title:t.label}},[e._v(e._s(e._f("handleLength")(t.label,7))+" ")])],1)],1)})),1)],1)],1)},o=[],i=a("d696"),s=a("cc64"),r=(a("4bce"),a("f8c2"),a("509f"),a("47e8"),a("678d"),a("5aae"),a("22f7"),a("1ae6"),a("a1c0")),l=a("2460"),c=a("4bbd"),u=a("0e7d"),d={name:"BasicReport",components:{CustomizedDialog:l["default"],CustomizedTable:r["default"]},mixins:[c["a"],u["a"]],props:{showCost:String,tableHeader:{type:Array},storageName:String,sumUrl:String,tableDataUrl:String,formData:{type:Object}},created:function(){this.costSumCopy=Object.assign({},this.summaryCostSum),this.consumeCostSumCopy=Object.assign({},this.consumeCostSum)},watch:{tableHeader:{immediate:!0,handler:function(t){this.checkedValue=t.reduce((function(t,e,a){return e.index=a,t[e.prop]=e,t}),{}),this.getHeader()}}},activated:function(){var t=JSON.parse(this.$common.getLocalStorage(this.storageName,3));this.fixedHeaderProp=t||Object.keys(this.checkedValue),this.getHeader(),this.tableLoad()},data:function(){return{fixedHeaderProp:[],visibleDialog:!1,checkedValue:null,summaryCostSum:{ad_cost_sum:0,adv_cost_sum:0,agent_cost_sum:0,grants_cost_sum:0,un_grants_cost_sum:0},planCostSum:0,consumeCostSum:{cost:0,agent_cost:0,grants_cost:0,un_grants_cost:0},costSumCopy:null,consumeCostSumCopy:null,loading:!1,header:null}},methods:{resetCostSum:function(){"summary"===this.showCost?this.summaryCostSum=Object(s["a"])({},this.costSumCopy):"plan"===this.showCost?this.planCostSum=0:this.consumeCostSum=Object(s["a"])({},this.consumeCostSumCopy)},handleSum:function(){var t,e=this;this.resetCostSum(),this.$http.get(this.sumUrl,{params:(t={start_date:this.$common.getNewDay(this.formData.dateValue[0]),end_date:this.$common.getNewDay(this.formData.dateValue[1])},Object(i["a"])(t,this.formData.selectValue,this.formData.inputValue.trim()),Object(i["a"])(t,"company_id",this.formData.agentCustomer),Object(i["a"])(t,"agent_id",this.formData.agentAccount),Object(i["a"])(t,"child_agent_id",this.formData.subAgentAccount),Object(i["a"])(t,"inventory",this.formData.platform),Object(i["a"])(t,"filter",this.formData.addOptionsFull?JSON.stringify(this.formData.filterData):""),t)}).then((function(t){200===t.data.code&&("summary"===e.showCost?e.summaryCostSum=Object(s["a"])({},t.data.data):"plan"===e.showCost?e.planCostSum=t.data.data.cost:e.consumeCostSum=Object(s["a"])({},t.data.data))}))["catch"]((function(t){console.warn(t)}))["finally"]((function(){}))},requestTable:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.$http.get(this.tableDataUrl,{params:(t={start_date:this.$common.getNewDay(this.formData.dateValue[0]),end_date:this.$common.getNewDay(this.formData.dateValue[1]),order:this.order,sort:this.sort},Object(i["a"])(t,this.formData.selectValue,this.formData.inputValue.trim()),Object(i["a"])(t,"company_id",this.formData.agentCustomer),Object(i["a"])(t,"agent_id",this.formData.agentAccount),Object(i["a"])(t,"child_agent_id",this.formData.subAgentAccount),Object(i["a"])(t,"filter",this.formData.addOptionsFull?JSON.stringify(this.formData.filterData):""),Object(i["a"])(t,"inventory",this.formData.platform),Object(i["a"])(t,"is_export",this["export"]?this["export"]:""),Object(i["a"])(t,"page",e),Object(i["a"])(t,"page_size",this.pageSize),t)})},tableLoad:function(t){var e=this;this.loading=!0,this.requestTable(t).then((function(a){200===a.data.code&&(e.tableData=a.data.data.list,e.total=Number(a.data.data.pagination.total),e.currentPage=t)}))["catch"]((function(t){console.warn(t)}))["finally"]((function(){e.$nextTick(e.$refs.customizedTable.doLayout),e.loading=!1,e.handleSum()}))},select:function(){this.visibleDialog=!0},closeDialog:function(){this.fixedHeaderProp.length||(this.header=this.tableHeader,this.$nextTick(this.$refs.customizedTable.updateColumnsWidth),this.tableLoad()),this.visibleDialog=!1},getHeader:function(){var t=this;this.header=this.fixedHeaderProp.map((function(e){return t.checkedValue[e]})).sort((function(t,e){return t.index-e.index}))},submitData:function(){this.$common.setLocalStorage(this.storageName,JSON.stringify(this.fixedHeaderProp)),this.visibleDialog=!1,this.getHeader(),this.$nextTick(this.$refs.customizedTable.updateColumnsWidth)}}},m=d,p=(a("d5cb"),a("cba8")),h=Object(p["a"])(m,n,o,!1,null,"224cc264",null);e["a"]=h.exports},a01c:function(t,e,a){"use strict";function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,n=new Array(e);a<e;a++)n[a]=t[a];return n}a.d(e,"a",(function(){return n}))},c91b:function(t,e,a){var n=a("6532"),o=n.match(/firefox\/(\d+)/i);t.exports=!!o&&+o[1]},d5cb:function(t,e,a){"use strict";a("4633")},e15d:function(t,e,a){var n=a("9c15"),o=a("7c9d"),i=a("774a"),s=!i((function(t){Array.from(t)}));n({target:"Array",stat:!0,forced:s},{from:o})},e9db:function(t,e,a){var n=a("6532");t.exports=/MSIE|Trident/.test(n)}}]);