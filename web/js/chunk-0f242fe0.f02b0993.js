(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0f242fe0"],{"05ce":function(t,e,n){var a=n("6809").PROPER,r=n("2c48"),i=n("cb1f"),s="​᠎";t.exports=function(t){return r((function(){return!!i[t]()||s[t]()!==s||a&&i[t].name!==t}))}},"0d2c":function(t,e,n){var a=n("ae28"),r=a("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(n){try{return e[r]=!1,"/./"[t](e)}catch(a){}}return!1}},"3c42":function(t,e,n){var a=n("9c15"),r=n("8655"),i=n("24bc"),s=n("51c1"),o=n("6532"),c=n("b072"),u=/MSIE .\./.test(o),l=r.Function,d=function(t){return function(e,n){var a=arguments.length>2,r=a?c(arguments,2):void 0;return t(a?function(){i(s(e)?e:l(e),this,r)}:e,n)}};a({global:!0,bind:!0,forced:u},{setTimeout:d(r.setTimeout),setInterval:d(r.setInterval)})},"47e8":function(t,e,n){"use strict";var a=n("9c15"),r=n("b5db").trim,i=n("05ce");a({target:"String",proto:!0,forced:i("trim")},{trim:function(){return r(this)}})},"4bbd":function(t,e,n){"use strict";e["a"]={data:function(){return{pageSize:10,total:0,currentPage:1,header:null,tableData:[],loading:!1}},mounted:function(){},methods:{pageChange:function(t,e,n){this.currentPage=n,t.call(e,n)},pageSizeChange:function(t,e,n){this.pageSize=n,this.pageChange(t,e,1)}}}},"5adf":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"overflow-scroll-y flex-1 flex-vertical"},[n("div",{staticClass:"flex-vertical flex-1 m-l-r-16"},[t._m(0),n("el-form",{ref:"addOptions",staticClass:"customized-form padding-top background-white p-l-r-32",attrs:{inline:!0,model:t.optionsForm}},[n("div",{staticClass:"flex"},[n("span",{staticClass:"inline-block form-item-title"},[t._v("时间筛选")]),n("div",{staticClass:"flex-1"},[n("el-form-item",{attrs:{prop:"dateValue"}},[n("customized-time-picker",{staticClass:"time-picker long-item",attrs:{date:t.optionsForm.dateValue,shortcutsSetting:t.shortcutsSetting,"max-date":0,"min-date":t.minDate},on:{"update:date":function(e){return t.$set(t.optionsForm,"dateValue",e)}}})],1),n("el-form-item",{staticClass:"search-content",attrs:{prop:"inputValue",required:!1}},[n("el-input",{staticClass:"long-item",attrs:{"prefix-icon":"el-icon-search",placeholder:"请输入下载文件信息",clearable:""},model:{value:t.optionsForm.inputValue,callback:function(e){t.$set(t.optionsForm,"inputValue",e)},expression:"optionsForm.inputValue"}})],1),n("el-form-item",{staticClass:"search-btn"},[n("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.search()}}},[t._v("查询")]),n("el-button",{staticClass:"reset",on:{click:t.reset}},[t._v("重置")])],1)],1)])]),n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"flex-1 flex-vertical"},[0===t.tableData.length?n("div",{staticClass:"background-white p-l-r-32 m-t-20 flex-1 flex-vertical table-box"},[n("span",{staticClass:"empty-text"},[t._v("暂无数据")])]):t._e(),t._l(t.tableData,(function(e,a){return n("div",{key:e.date_time,staticClass:"background-white m-p"},[n("span",{staticClass:"date-time"},[t._v(t._s(e.date_time))]),t._l(e.children,(function(a,r){return n("div",{key:e.id,staticClass:"flex file-item"},[n("div",{staticClass:"excel"},[n("svg-icon",{attrs:{"icon-name":"excel"}})],1),n("div",[n("p",{staticClass:"file-name"},[t._v(t._s(a.file_name))]),n("el-progress",{attrs:{percentage:t.getPercentage(a),status:"success"}})],1),n("div",{staticClass:"message"},[n("span",["2"===a.status||"3"===a.status?n("svg-icon",{attrs:{"icon-name":t.statusIcon[a.status]}}):t._e(),n("i",{staticClass:"loading-status"},[t._v(t._s(t.statusShow(a)))])],1)]),n("el-button",{attrs:{type:"primary",disabled:"2"!==a.status},on:{click:function(e){return t.downloadReport(a.id)}}},[t._v("下载到本地")])],1)}))],2)}))],2)],1)])},r=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"breadcrumb background-white font-bold"},[t._v("下载中心"),n("span",{staticClass:"mind-text"},[t._v("(下载中心仅保存30天数据,请及时下载报表内容)")])])}],i=(n("d762"),n("f8c2"),n("4d38"),n("47e8"),n("3c42"),n("c08f"),n("09ed"),n("4bce"),n("63a77"),n("dbc7"),n("7eeb")),s=n("4bbd"),o={name:"DownloadCenter",components:{},mixins:[s["a"]],created:function(){},mounted:function(){this.tableLoad()},destroyed:function(){clearInterval(this.interval)},data:function(){return{interval:"",statusIcon:{2:"opsuccess",3:"opfail"},statistical:{cost:"",transfer_in:"",transfer_out:"",income:""},optionsForm:{dateValue:Object(i["f"])(1,0),inputValue:""},minDate:Math.ceil((new Date-new Date("2018-1-1"))/864e5),shortcutsSetting:["yesterday","lastSeven","lastThirty","lastWeek"],tableDataMap:null}},methods:{statusShow:function(t){return"0"===t.status?"准备中":"1"===t.status?"云端加载"+this.getPercentage(t)+"%，请稍等":"2"===t.status?"云端加载完成":"3"===t.status?"下载失败，请重新下载":void 0},getPercentage:function(t){if("0"===t.status||"3"===t.status)return 0;if("2"===t.status)return 100;var e=t.current_num/t.total_num*100;return t?parseInt(e.toString()):""},requestTable:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.$http.get("tool/download/index",{params:{start_date:this.$common.getNewDay(this.optionsForm.dateValue[0]),end_date:this.$common.getNewDay(this.optionsForm.dateValue[1]),filename:this.optionsForm.inputValue.trim(),page:t,page_size:this.pageSize}})},requestProgress:function(){return this.$http.get("tool/download/progress-bar",{params:{start_date:this.$common.getNewDay(this.optionsForm.dateValue[0]),end_date:this.$common.getNewDay(this.optionsForm.dateValue[1])}})},intervalHelper:function(){var t=this;this.interval=setInterval((function(){t.requestProgress().then((function(e){if(200===e.data.code&&0!==e.data.data.list.length){var n=!1;e.data.data.list.forEach((function(e){t.tableDataMap[e.id]&&(Object.assign(t.tableDataMap[e.id],e),n||(n="0"===e.status||"1"===e.status))})),n||clearInterval(t.interval)}}))["catch"]((function(t){console.warn(t)}))["finally"]((function(){}))}),2e3)},tableLoad:function(t){var e=this;this.loading=!0,this.requestTable(t).then((function(t){200===t.data.code&&(e.tableData=t.data.data.list,0!==t.data.data.list.length&&(e.tableDataMap=e.tableData.reduce((function(t,e){return e.children.reduce((function(t,e){return t[e.id]=e,t}),t),t}),{}),e.intervalHelper()))}))["catch"]((function(t){console.warn(t)}))["finally"]((function(){e.loading=!1}))},search:function(){this.interval&&clearInterval(this.interval),this.tableLoad()},reset:function(){this.optionsForm.inputValue="",this.optionsForm.dateValue=Object(i["f"])(1,0)},requestDownload:function(t){return this.$http.get("tool/download/download",{params:{id:t},responseType:"blob"})},downloadReport:function(t){var e=this;this.requestDownload(t).then((function(t){t.data.type.includes("json")||e.$common.downloadFileBlob(t)}))}}},c=o,u=(n("f581"),n("cba8")),l=Object(u["a"])(c,a,r,!1,null,"6e820491",null);e["default"]=l.exports},"63a77":function(t,e,n){"use strict";var a=n("9c15"),r=n("df4d").includes,i=n("080d");a({target:"Array",proto:!0},{includes:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),i("includes")},6860:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));n("c510"),n("f8c2"),n("6010"),n("e15d"),n("e4de"),n("d64c"),n("98ff");var a=n("a01c");function r(t,e){if(t){if("string"===typeof t)return Object(a["a"])(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Object(a["a"])(t,e):void 0}}},7980:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));n("828e");var a=n("a01c");function r(t){if(Array.isArray(t))return Object(a["a"])(t)}n("74c4"),n("1f83"),n("f8c2"),n("2da9"),n("e4de"),n("b00a"),n("e15d");function i(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}var s=n("6860");function o(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(t){return r(t)||i(t)||Object(s["a"])(t)||o()}},"7eeb":function(t,e,n){"use strict";n.d(e,"f",(function(){return i})),n.d(e,"c",(function(){return s})),n.d(e,"g",(function(){return o})),n.d(e,"b",(function(){return c})),n.d(e,"e",(function(){return u})),n.d(e,"a",(function(){return l})),n.d(e,"d",(function(){return d}));var a=n("7980"),r=(n("1ae6"),n("f904")),i=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=new Date,a=new Date,r=e+t-1;return n.setTime(n.getTime()-864e5*r),a.setTime(a.getTime()-864e5*e),[n,a]},s=function(){var t=new Date,e=new Date,n=t.getDay()>0?t.getDay()-1:6;return e.setTime(e.getTime()-864e5*n),[e,t]},o=function(){var t=new Date,e=new Date,n=t.getDay();return e.setTime(e.getTime()-864e5*(n+6)),t.setTime(t.getTime()-864e5*n),[e,t]},c=function(){var t=new Date,e=new Date,n=t.getDate()-1;return e.setTime(e.getTime()-864e5*n),[e,t]},u=function(){var t=new Date,e=t.getDate(),n=t.getFullYear()-(t.getMonth()>0?0:1),a=(t.getMonth()+11)%12,r=new Date(n,a,1);return t.setTime(t.getTime()-864e5*e),[r,t]},l={yesterday:{label:"昨日消耗",legend:"前日环比",handler:i,params:[1,1]},lastSeven:{label:"近七日消耗",legend:"上一周期环比",handler:i,params:[7,1]},thisWeek:{label:"本周消耗",legend:"上一周环比",handler:s},thisMonth:{label:"本月消耗",legend:"上月环比",handler:c}},d=function(t){var e=l[t],n=e.params?e.params:[],i=e.handler.apply(e,Object(a["a"])(n));return i=i.map((function(t){return r["a"].getNewDay(t)})),i}},"828e":function(t,e,n){var a=n("9c15"),r=n("81c6");a({target:"Array",stat:!0},{isArray:r})},a01c:function(t,e,n){"use strict";function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}n.d(e,"a",(function(){return a}))},a45d:function(t,e,n){var a=n("8655"),r=n("7d86"),i=a.TypeError;t.exports=function(t){if(r(t))throw i("The method doesn't accept regular expressions");return t}},d762:function(t,e,n){var a=n("9c15"),r=n("e48f");a({global:!0,forced:parseInt!=r},{parseInt:r})},dbc7:function(t,e,n){"use strict";var a=n("9c15"),r=n("5008"),i=n("a45d"),s=n("458e"),o=n("ffb3"),c=n("0d2c"),u=r("".indexOf);a({target:"String",proto:!0,forced:!c("includes")},{includes:function(t){return!!~u(o(s(this)),o(i(t)),arguments.length>1?arguments[1]:void 0)}})},e15d:function(t,e,n){var a=n("9c15"),r=n("7c9d"),i=n("774a"),s=!i((function(t){Array.from(t)}));a({target:"Array",stat:!0,forced:s},{from:r})},e48f:function(t,e,n){var a=n("8655"),r=n("2c48"),i=n("5008"),s=n("ffb3"),o=n("b5db").trim,c=n("cb1f"),u=a.parseInt,l=a.Symbol,d=l&&l.iterator,f=/^[+-]?0x/i,m=i(f.exec),p=8!==u(c+"08")||22!==u(c+"0x16")||d&&!r((function(){u(Object(d))}));t.exports=p?function(t,e){var n=o(s(t));return u(n,e>>>0||(m(f,n)?16:10))}:u},e639:function(t,e,n){},f581:function(t,e,n){"use strict";n("e639")}}]);